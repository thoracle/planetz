<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Progress Display Test</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/card-inventory.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            font-family: 'Orbitron', monospace;
        }
        
        .test-header {
            text-align: center;
            color: #00ffff;
            margin-bottom: 30px;
        }
        
        .test-header h1 {
            margin: 0;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }
        
        .test-description {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(0, 255, 255, 0.2);
            margin-bottom: 30px;
            color: #ffffff;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .test-actions {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-btn {
            background: linear-gradient(135deg, #0066cc, #004499);
            color: #ffffff;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-family: inherit;
            font-weight: bold;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 255, 255, 0.3);
        }
        
        .test-btn:hover {
            background: linear-gradient(135deg, #0088ff, #0066cc);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 136, 255, 0.3);
        }
        
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
        }
        
        .debug-info {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 0, 0.3);
            margin-top: 20px;
            color: #ffff00;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üé¥ Card Progress Display Test</h1>
            <p>Testing enhanced card count and upgrade requirements display</p>
        </div>
        
        <div class="test-description">
            <h3>‚ú® Enhanced Features:</h3>
            <ul>
                <li><strong>Clear Progress Display:</strong> Shows "current cards / cards needed for next level"</li>
                <li><strong>Visual Progress Bar:</strong> Animated progress bar with shimmer effect</li>
                <li><strong>Level Indicator:</strong> Shows target level (e.g., "‚Üí Lv.3") or "(MAX)" for max level</li>
                <li><strong>Enhanced Styling:</strong> Better contrast and visibility for upgrade progress</li>
                <li><strong>Upgrade Requirements:</strong> Based on realistic progression (2, 3, 5, 8, 12, 20, 32, 50, 80)</li>
            </ul>
        </div>
        
        <div class="test-actions">
            <button class="test-btn" onclick="generateTestCards()">üéÅ Generate Test Cards</button>
            <button class="test-btn" onclick="addSpecificCards()">‚ö° Add Specific Cards</button>
            <button class="test-btn" onclick="clearInventory()">üóëÔ∏è Clear Inventory</button>
        </div>
        
        <div id="inventory-display" class="inventory-grid">
            <!-- Cards will be displayed here -->
        </div>
        
        <div class="debug-info">
            <h4>üîß Debug Information:</h4>
            <div id="debug-output">Ready to test card progress display...</div>
        </div>
    </div>

    <script type="module">
        import CardInventoryUI from './js/ui/CardInventoryUI.js';
        import CardInventory from './js/ship/CardInventory.js';
        import NFTCard, { CARD_TYPES } from './js/ship/NFTCard.js';

        // Initialize inventory system
        const inventory = new CardInventory();
        let cardInventoryUI;

        // Create a simplified UI for testing
        function createTestUI() {
            const container = document.getElementById('inventory-display');
            
            // Get all discovered cards
            const discoveredCards = inventory.getDiscoveredCards();
            
            if (discoveredCards.length === 0) {
                container.innerHTML = '<div style="color: #888; text-align: center; grid-column: 1 / -1;">No cards in inventory. Generate some test cards!</div>';
                return;
            }
            
            // Create card displays
            container.innerHTML = discoveredCards.map(stack => {
                const progressPercent = (stack.count / inventory.getUpgradeRequirements(stack.level + 1)) * 100;
                const cardIcon = stack.sampleCard ? stack.sampleCard.getIcon() : '‚ùì';
                
                return `
                    <div class="card-stack ${stack.rarity}" data-card-type="${stack.cardType}">
                        <div class="card-header">
                            <span class="card-icon">${cardIcon}</span>
                            <span class="card-name">${stack.name}</span>
                            <span class="card-count">√ó${stack.count}</span>
                        </div>
                        <div class="card-level">Level ${stack.level}</div>
                        <div class="card-rarity">${stack.rarity.toUpperCase()}</div>
                        <div class="upgrade-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${Math.min(progressPercent, 100)}%"></div>
                            </div>
                            <div class="progress-text">
                                ${stack.count} / ${inventory.getUpgradeRequirements(stack.level + 1)}
                                ${stack.level < 10 ? ` ‚Üí Lv.${stack.level + 1}` : ' (MAX)'}
                            </div>
                        </div>
                        ${stack.canUpgrade ? `<button class="upgrade-btn" onclick="upgradeCard('${stack.cardType}')">UPGRADE</button>` : ''}
                    </div>
                `;
            }).join('');
            
            updateDebugInfo();
        }
        
        function updateDebugInfo() {
            const stats = inventory.getCollectionStats();
            const discoveredCards = inventory.getDiscoveredCards();
            
            const debugOutput = document.getElementById('debug-output');
            debugOutput.innerHTML = `
                <strong>Collection Stats:</strong><br>
                ‚Ä¢ Discovered: ${stats.discoveredCardTypes}/${stats.totalCardTypes} card types<br>
                ‚Ä¢ Total Cards: ${stats.totalCardsCollected}<br>
                ‚Ä¢ Completion: ${stats.completionPercentage}%<br><br>
                
                <strong>Card Details:</strong><br>
                ${discoveredCards.map(stack => 
                    `‚Ä¢ ${stack.name}: ${stack.count} cards, Level ${stack.level}, needs ${inventory.getUpgradeRequirements(stack.level + 1)} for next level`
                ).join('<br>')}
            `;
        }
        
        // Test functions
        window.generateTestCards = function() {
            console.log('üéÅ Generating test cards...');
            
            // Generate a variety of cards with different counts
            const testCards = [
                { type: CARD_TYPES.LASER_CANNON, rarity: 'common', count: 1 },
                { type: CARD_TYPES.PLASMA_RIFLE, rarity: 'common', count: 3 },
                { type: CARD_TYPES.QUANTUM_REACTOR, rarity: 'rare', count: 2 },
                { type: CARD_TYPES.DARK_MATTER_CORE, rarity: 'epic', count: 4 },
                { type: CARD_TYPES.PHASE_SHIELD, rarity: 'epic', count: 7 },
                { type: CARD_TYPES.TEMPORAL_ENGINE, rarity: 'legendary', count: 1 },
                { type: CARD_TYPES.HULL_PLATING, rarity: 'common', count: 5 },
                { type: CARD_TYPES.ADAPTIVE_ARMOR, rarity: 'epic', count: 8 }
            ];
            
            testCards.forEach(cardSpec => {
                for (let i = 0; i < cardSpec.count; i++) {
                    const card = new NFTCard(cardSpec.type, cardSpec.rarity);
                    inventory.addCard(card);
                }
            });
            
            createTestUI();
            console.log('‚úÖ Test cards generated!');
        };
        
        window.addSpecificCards = function() {
            console.log('‚ö° Adding specific cards for upgrade testing...');
            
            // Add cards that are close to upgrade thresholds
            const upgradeTestCards = [
                { type: CARD_TYPES.MISSILE_LAUNCHER, rarity: 'rare', count: 2 }, // Exactly enough for level 2
                { type: CARD_TYPES.SHIELD_GENERATOR, rarity: 'rare', count: 4 }, // Almost enough for level 3 (needs 5)
                { type: CARD_TYPES.WARP_DRIVE, rarity: 'epic', count: 8 }  // Exactly enough for level 4
            ];
            
            upgradeTestCards.forEach(cardSpec => {
                for (let i = 0; i < cardSpec.count; i++) {
                    const card = new NFTCard(cardSpec.type, cardSpec.rarity);
                    inventory.addCard(card);
                }
            });
            
            createTestUI();
            console.log('‚úÖ Specific cards added for upgrade testing!');
        };
        
        window.upgradeCard = function(cardType) {
            console.log(`üîß Attempting to upgrade ${cardType}...`);
            const result = inventory.upgradeCard(cardType);
            
            if (result.success) {
                console.log(`‚úÖ Upgraded ${cardType} to level ${result.newLevel}!`);
                createTestUI();
            } else {
                console.log(`‚ùå Upgrade failed: ${result.error}`);
            }
        };
        
        window.clearInventory = function() {
            console.log('üóëÔ∏è Clearing inventory...');
            inventory.reset();
            createTestUI();
            console.log('‚úÖ Inventory cleared!');
        };
        
        // Initialize the test
        createTestUI();
        console.log('üöÄ Card Progress Display Test initialized!');
    </script>
</body>
</html> 